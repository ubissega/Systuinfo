<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Hugo 0.84.0">
    <title>Offcanvas navbar template · Bootstrap v5.0</title>

    <link rel="canonical" href="https://getbootstrap.com/docs/5.0/examples/offcanvas-navbar/">

    

    <!-- Bootstrap core CSS -->
<link href="css/bootstrap.min.css" rel="stylesheet">

    <style>
      .bd-placeholder-img {
        font-size: 1.125rem;
        text-anchor: middle;
        -webkit-user-select: none;
        -moz-user-select: none;
        user-select: none;
      }

      @media (min-width: 768px) {
        .bd-placeholder-img-lg {
          font-size: 3.5rem;
        }
          nav,footer{
          background: #00990090;
          color: white;
        }
      }
      body {
        /* Define um gradiente linear como plano de fundo *//* Define um gradiente linear como plano de fundo */
        background: url(./img/bg/main.png) no-repeat fixed;
        background-size: cover;
        
      }
      nav,footer{
          background: #00990090;
        color: white;
      }
      .titular_page{
        border: solid 2px #55e7ff;
        background: #55e7ff90;
        color: #55e7ff;
      }
      .bg-padrao{
        background: #55e7ff;
      }

      .btn{
        background: #55e7ff90;
        color: white;
      }
      .btn:hover{
        background: #55e7ff;

      }
    </style>

    
    <!-- Custom styles for this template -->
    <link href="css/offcanvas.css" rel="stylesheet">
  </head>
  <body class="bg-light">
 <nav class=" navbar bg-body-tertiary fixed-top" >
  <div class="container">
    <h1 class="text-uppercase navbar-brand">systuinfo</h1>
    <button class="text-uppercase btn text-white border" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasNavbar" aria-controls="offcanvasNavbar" aria-label="Toggle navigation">
       Menu
    </button>
    <div class="offcanvas offcanvas-end bg-padrao" tabindex="-1" id="offcanvasNavbar" aria-labelledby="offcanvasNavbarLabel">
      <div class="offcanvas-header">
        <h5 class="" id="offcanvasNavbarLabel">Opcoes do menu</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
      </div>
      <div class="offcanvas-body">
        <ul class="navbar-nav justify-content-end flex-grow-1 pe-3">

          <li><a class="dropdown-item" href="index.html">Pagina inicial</a></li>
          <li><a class="dropdown-item" href="index.html">Iniciar sessao</a></li>
          <li><hr class="dropdown-divider"></li>
          <li><a class="dropdown-item" href="#">Manual de uso</a></li>          
    </div>
  </div>
</nav>

<main class="container mb-5">
  <form action="#" class=" needs-validation " novalidate>
    <div class="row titular_page">
      
      <div class=" d-flex align-items-center p-3 m-2 text-uppercase rounded shadow-sm">
        <img class="me-3" src="./img/perfil/user.png" alt="" width="48" height="48">
        <div class="lh-1">
          <h1 class="h6 mb-0 lh-1">Registo do estudante</h1>
        </div>
      </div>
    </div>
    <div class="row"> 
      <p class="col bg-padrao mt-2 ">
        Aviso: Por favor, preencha todos os campos obrigatórios antes de prosseguir. Campos obrigatórios são essenciais para garantir que tenhamos todas as informações necessárias para processar sua solicitação com precisão e eficiência.
      </p>   
      <div class="col-md-5 mt-2 p-3 bg-body  shadow-sm">
        <div class="m-2">
          <h6 class="border-bottom pb-2 mb-0">Dados pessoais</h6>
          <div class="d-flex text-muted pb-1">   
            <p class=" small w-100">
              <strong class="d-block text-gray-dark">Primeiro nome</strong>          
              <input type="text" name="primeiro_nome" class="form-control" maxLength="20"  required>
                  <span id="spanpnome" class="invalid-feedback">Obrigatorio</span>
            </p>
          </div>
           <div class="d-flex text-muted pb-1">   
            <p class=" small w-100">
              <strong class="d-block text-gray-dark">Nome do meio</strong>          
              <input type="text" name="nome_meio" class="form-control" maxLength="20"  required>
                  <span id="spannomemeio" class="invalid-feedback">Obrigatorio</span>
            </p>
          </div>
           <div class="d-flex text-muted pb-1">   
            <p class=" small w-100">
              <strong class="d-block text-gray-dark">Ultimo nome</strong>          
              <input type="text" name="ultimo_nome" class="form-control" maxLength="20"  required>
                  <span id="spanunome" class="invalid-feedback">Obrigatorio</span>
            </p>
          </div>
           <div class="d-flex text-muted pb-1">   
            <p class=" small w-100">
              <strong class="d-block text-gray-dark">Sexo</strong>          
              <input type="text" name="sexo" class="form-control" maxLength="10"  required>
                  <span id="spansexo" class="invalid-feedback">Obrigatorio</span>
            </p>
          </div>
           <div class="d-flex text-muted pb-1">   
            <p class=" small w-100">
              <strong class="d-block text-gray-dark">Data de nascimento</strong>          
              <input type="date" name="data_nascimento" class="form-control" required min="1900-01-01">

                  <span id="spandatanacimento" class="invalid-feedback">Obrigatorio</span>
            </p>
          </div>
        </div>
      </div>

      <div class="col-md-5 mt-2 p-3 bg-body shadow-sm">
        <div class="m-2">
          
          <h6 class="border-bottom pb-2 mb-0">Dados de localizacao</h6>
          <div class="d-flex text-muted pb-1">   
            <p class=" small w-100">
              <strong class="d-block text-gray-dark">Distrito</strong>          
              <input type="text" name="distrito" class="form-control" maxLength="15"  required>
                  <span id="spandistrito" class="invalid-feedback">Obrigatorio</span>
            </p>
          </div>
           <div class="d-flex text-muted pb-1">   
            <p class=" small w-100">
              <strong class="d-block text-gray-dark">Morada</strong>          
              <input type="text" name="morada" class="form-control" maxLength="15"  required>
                  <span id="spanmorada" class="invalid-feedback">Obrigatorio</span>
            </p>
          </div>
           <div class="d-flex text-muted pb-1">   
            <p class=" small w-100">
              <strong class="d-block text-gray-dark">Telefone</strong>          
              <input type="text" name="telefone" class="form-control" maxLength="9" required>
                  <span id="spantelefone" class="invalid-feedback">Obrigatorio</span>
            </p>
          </div>
          <div class="row">
            
             <div class=" col-md-8 d-flex text-muted pb-1">   
              <p class=" small w-100">
                <strong class="d-block text-gray-dark">Foto do perfil</strong> 
                <label class="mb-2">A foto a ser escolhida deve ser quase quadrada ou quadrada. Caso nao obter uma imagem suave pode adicionar mais tarde.</label>
                <input type="file" name="pic_perfil" class="form-control" >
              </p>
            </div>
             <div class=" col-md-4 d-flex text-muted pb-1">   
              <p class=" small w-100">
                <strong class="d-block text-gray-dark">Mostra</strong>          
                <img id="imagem-preview" src="./img/perfil/user.png" alt="Imagem de Perfil" class="w-100">
              </p>
            </div>
          </div>

        </div>
      </div>
    </div>
    <div class="row">
      <p class="col bg-padrao mt-2">
        Por favor, lembre-se de cuidar das suas credenciais de forma segura e confidencial. 
      </p>
      <div class="col-md-5 mt-2 p-3 bg-body  shadow-sm">
        <div class="m-2">
            
          <h6 class="border-bottom pb-2 mb-0">Credencial</h6>
           <div class="d-flex text-muted pb-1">   
            <p class=" small w-100">
              <strong class="d-block text-gray-dark">Email</strong>          
              <input type="text" name="email" class="form-control" required>
                  <span id="spanemail" class="invalid-feedback">Obrigatorio</span>
            </p>
          </div>
           <div class="d-flex text-muted pb-1">   
            <p class=" small w-100">
              <strong class="d-block text-gray-dark">Senha</strong>          
              <input type="text" name="senha" class="form-control" maxLength="6"  required>
                  <span id="spansenha" class="invalid-feedback">Obrigatorio</span>
            </p>
          </div>
        </div>
      </div>
      <div class="col-md-5 mt-2 p-3 bg-body  shadow-sm">
        <div class="m-2">
          
          <h6 class="border-bottom pb-2 mb-0">Recomendamos para a redifinicao da senha</h6>
           <div class="d-flex text-muted pb-1">   
            <p class=" small w-100">
              <strong class="d-block text-gray-dark">Pergunta</strong>   
              <select class="form-select" name="pergunta_recuperacao" required>
                        <option active value="">Mencione a pergunta</option>
                        <option>Qual ee o primerio nome do seu professor/a da primeira classe?</option>
                        <option>Qual musica tocas quando ee o dia do natal?</option>
                        <option>Qual ee o apelido do seu presidente favorito?</option>
                </select>      
                  <span id="span_pergunta_rec" class="invalid-feedback">Obrigatorio</span>
            </p>
          </div>
           <div class="d-flex text-muted pb-1">   
            <p class=" small w-100">
              <strong class="d-block text-gray-dark">Resposta</strong>          
              <input type="text" name="resposta_recuperacao" class="form-control" maxLength="30"  required>
                  <span id="span_resposta_rec" class="invalid-feedback">Obrigatorio</span>
            </p>
          </div>
        </div>
      </div>
      <button type="submit" class="col-md-12 btn border mt-2" >Submeter</button>
     
    </div>
  </form>
</main>

<footer class="footer text-center text-uppercase fixed-bottom">
  Todos os direitos reservados copyriht systuinfo . 2024
</footer>

<script type="text/javascript">
  // Obtém a data atual
  var hoje = new Date();

  // Obtém o ano atual
  var anoAtual = hoje.getFullYear();

  // Subtrai 18 anos do ano atual
  var anoDezoitoAnosAtras = anoAtual - 18;
  document.querySelector('input[name="data_nascimento"]').setAttribute('max',anoDezoitoAnosAtras+'-12-31');

</script>

    <script src="js/bootstrap.bundle.min.js"></script>

    <script src="js/offcanvas.js"></script>
    <script type="module">

    //====================================
    //INICIALIZANDO A CONEXAO COM FIREBASE
    //====================================

    //Importacao do que precisamos trabalhar
    //--------------------------------------
    import {initializeApp} from "https://www.gstatic.com/firebasejs/9.1.0/firebase-app.js";
    import {getDatabase,get,ref,set,child} from "https://www.gstatic.com/firebasejs/9.1.0/firebase-database.js";
    import {getAuth, createUserWithEmailAndPassword} from "https://www.gstatic.com/firebasejs/9.1.0/firebase-auth.js";
    import {getStorage,getDownloadURL, ref as storageRef, uploadBytes } from "https://www.gstatic.com/firebasejs/9.1.0/firebase-storage.js";

      const firebaseConfig = {
            apiKey: "AIzaSyDohCeHRGxRiO4sfN9pOFHVUqe01cuzUEg",
            authDomain: "systuinfo.firebaseapp.com",
            databaseURL: "https://systuinfo-default-rtdb.firebaseio.com",
            projectId: "systuinfo",
            storageBucket: "systuinfo.appspot.com",
            messagingSenderId: "604412345972",
            appId: "1:604412345972:web:96338d9c4f5853d1765b21"
       };
       
       // Inicialize o Firebase
      var app=initializeApp(firebaseConfig);
      var db=getDatabase(app);
      var storage = getStorage(app);
      var auth = getAuth(app);


      //=============================
      //GERADOR E VERIFICA:|AO DO ID
      //=============================
        //var id_user_gerado = Math.floor(Math.random(1111111111) * 9999999999);
        var id_img_gerado = Math.floor(Math.random(111111111111111) * 999999999999999);
        //var estadouser=isExistUserById(id_user_gerado);
        var estadoimg=isExistImgById(id_img_gerado);
        var i=0;

      while(estadoimg==1){
        estadoimg=isExistImgById(id_img_gerado);
        i++;
        if(i==10000){
          break;
        }
      }




          
            //verificarExistenciaID(numeroAleatorio);

          //=============================
          //GLOBARIAR VARIAVEIS
          //============================= 

          //Pessooal
          //--------------
          var primeiro_nome="";
          var nome_meio="";
          var ultimo_nome="";
          var sexo='';
          var data_nascimento="";

          //Localizacao
          //--------------
          var telefone="";
          var morada="";
          var distrito="";

          var inputImagem = document.querySelector('input[name="pic_perfil"]');
          var imagemPreview = document.getElementById('imagem-preview');  
          var arquivoImagem="";

          //Credeciais
          //--------------
          var email="";
          var senha="";

          //Recuperacao
          //--------------
          var pergunta_recuperacao="";
          var resposta_recuperacao="";    


          //========================================
          //IA de NOME
          //=======================================

          // Lista de nomes masculinos
          var nomesMasculinos = [
          "João", "Pedro", "Lucas", "Miguel", "Arthur",
          "Gabriel", "Enzo", "Matheus", "Heitor", "Davi"
          ];



          var paragrafo = document.getElementById('nomesFemininos');
          if (paragrafo) {  
             const nomesFemininos = paragrafo.textContent.trim().split(',');
          }


















          // Lista de nomes femininos
          var nomef=["Ana", "Joana", "Sofia", "Beatriz", "Laura", "Camila", "Isabella", "Gabriela", "Manuela", "Juliana", "Carolina", "Mariana", "Eduarda", "Valentina", "Letícia", "Natália", "Fernanda", "Vitória", "Amanda", "Fatima", "Aisha", "Salomé", "Adélia", "Mónica", "Anabela", "Gracinda", "Clarisse", "Ivone", "Edite", "Alice", "Luísa", "Elvira", "Ilda", "Celeste", "Zulmira", "Isabel", "Hortênsia", "Ester", "Jacinta", "Maria", "Ana", "Sofia", "Beatriz", "Joana", "Laura", "Inês", "Carolina", "Matilde", "Mariana", "Diana", "Filipa", "Leonor", "Rita", "Sara", "Catarina", "Margarida", "Mafalda", "Isabel", "Francisca", "Madalena", "Luísa", "Andreia", "Bruna", "Patrícia", "Débora", "Vanessa", "Cláudia", "Tânia", "Eduarda", "Helena", "Daniela", "Débora", "Telma", "Lídia", "Ana Rita", "Bárbara", "Soraia", "Vera", "Juliana", "Adriana", "Nicole", "Andreia", "Mónica", "Eliana", "Carla", "Marisa", "Ângela", "Joaquina", "Fernanda", "Célia", "Solange", "Vânia", "Fátima", "Patrícia", "Vanessa", "Cristiana", "Raquel", "Susana", "Sónia", "Lorena", "Carolina", "Yara", "Camila", "Lara", "Ema", "Rosana", "Dalila", "Bia", "Alice", "Clara", "Ester", "Flor", "Letícia", "Milena", "Lúcia", "Ivone", "Júlia", "Odete", "Tereza", "Nádia", "Paula", "Silvia", "Tânia", "Vitória", "Yara", "Zara", "Miriam", "Noélia", "Odete", "Rosário", "Sandra", "Teresa", "Ulrika", "Vera", "Ximena", "Yolanda", "Zélia", "Zilda", "Zuleica", "Adrielle", "Alana", "Alice", "Alícia", "Alina", "Alissa", "Althea", "Amália", "Amara", "Amélia", "Amora", "Anabela", "Anamar", "Ananda", "Andreza", "Antonella", "Arabela", "Ariadna", "Ariana", "Ayla", "Belinda", "Bianca", "Branca", "Brisa", "Calista", "Camile", "Cassandra", "Cecília", "Celina", "Clarice", "Cloé", "Dália", "Dandara", "Dani", "Dara", "Dayane", "Dora", "Dulce", "Érica", "Elisa", "Elvira", "Elza", "Ema", "Emanuela", "Erika", "Estela", "Esther", "Eva", "Fabiana", "Fábia", "Fernanda", "Flávia", "Francisca", "Gabriela", "Gaela", "Geórgia", "Giovanna", "Gisela", "Glória", "Graça", "Greta", "Helena", "Heloísa", "Hera", "Irene", "Irina", "Isa", "Isadora", "Iva", "Ivone", "Izabela", "Janaína", "Jéssica", "Júlia", "Juliana", "Jussara", "Kátia", "Kélia", "Laís", "Lara", "Larissa", "Lavinia", "Leandra", "Leticia", "Lia", "Liliana", "Lívia", "Lorena", "Lorraine", "Luana", "Luciana", "Ludmila", "Lurdes", "Luzia", "Madalena", "Magda", "Malu", "Manoela", "Marcele", "Marilene", "User", "continua", "ChatGPT", "Claro", "Maristela", "Marlene", "Marli", "Marta", "Márcia", "Mayara", "Melissa", "Micaela", "Milena", "Miriam", "Mirela", "Muriel", "Nara", "Natacha", "Natália", "Nayara", "Neide", "Neusa", "Nicole", "Noemi", "Norma", "Odete", "Olga", "Olívia", "Paola", "Patrícia", "Paula", "Paulina", "Poliana", "Priscila", "Rafaela", "Raquel", "Rayane", "Rebeca", "Regina", "Renata", "Rita", "Roberta", "Rúbia", "Sabrina", "Samara", "Samantha", "Sandra", "Sara", "Sibele", "Sílvia", "Simone", "Sofia", "Solange", "Stella", "Suzana", "Talita", "Tamara", "Tânia", "Tarsila", "Tereza", "Thais", "Thereza", "Túlia", "Úrsula", "Valéria", "Vanessa", "Verônica", "Vânia", "Vitória", "Viviane", "Walquiria", "Wanessa", "Yara", "Yasmin", "Yolanda", "Yonara", "Zaira", "Zara", "Zélia", "Zenaide", "Zilda", "Zuleica", "Zuleide", "Zulmira", "Zuma", "Zuri", "Zuleika", "Zuriel", "Zulima", "Zarah", "Zanele", "Zabana", "Zinat", "Zerlina", "Zaraí", "Zaira", "Zélia", "Zita", "Zoraida", "Zulena", "Zinia", "Zelia", "Zane", "Zitkala", "", "User", "continua", "ChatGPT", "", "Zayna", "Zuzana", "Zorica", "Zalika", "Zola", "Zabel", "Zelma", "Zafira", "Zinnia", "Zorina", "Zophia", "Zulema", "Zariya", "Zivanka", "Zephyra", "Zabrina", "Zefira", "Zsuzsa", "Zemfira", "Zuliana", "Zaneta", "Zelinda", "Zulekha", "Zoraida", "Zephyrine", "Zamina", "Zerina", "Zsuzsanna", "Zuzanna", "Zabelina", "Zuwena", "Zelinda", "Zaviera", "Zaynab", "Zephyrine", "Zelena", "Zsófia", "Zoraya", "Zareen", "Zelia", "Zsuzsanna", "Zipporah", "Zlata", "Zana", "Zinovia", "Zorica", "Zelma", "Zsazsa", "Zofia", "Zivanka", "Zabrina", "Zafira", "Zephyra", "Zulaika", "Zulma", "Zosia", "Zena", "Zula", "Zetta", "Zafira", "Zoraida", "Zabana", "Zeline", "Zola", "Zephyrine", "Zarah", "Zuleika", "Zada", "Zephyra", "Zuzela", "Zelma", "Zelenia", "Zasha", "Zarah", "Zoraya", "Zahirah", "Zephyrine", "Zoriana", "Zenda", "Zosima", "Zuma", "Zaida", "Zelinda", "Zuleika", "Zabel", "Zaira", "Zsuzsanna", "Ziv", "Zana", "Zella", "Zora", "Zoya", "Zafira", "Zuleika", "Zenaide", "Zinia", "Zelpha", "Zelphia", "Zoraida", "Zariya", "", "", "User", "contua", "ChatGPT", "", "Zula", "Zelena", "Zabel", "Zuzanna", "Zena", "Zola", "Zephyrine", "Zara", "Zuzana", "Zulaika", "Zandra", "Zephyra", "Zadie", "Zenaide", "Zephyrine", "Zuzanna", "Zelpha", "Zelia", "Zosia", "Zuzela", "Zephyra", "Zabina", "Zoraida", "Zulaika", "Zanna", "Zabrina", "Zelma", "Zulaika", "Zephyra", "Zara", "Zelinda", "Zorica", "Zephyrine", "Zaida", "Zuleika", "Zara", "Zelena", "Zsuzsanna", "Zephyrine", "Zora", "Zephyra", "Zulma", "Zena", "Zora", "Zephyrine", "Zuzana", "Zenaide", "Zelma", "Zulma", "Zephyra", "Zoraida", "Zelma", "Zuzanna", "Zuleika", "Zosia", "Zephyra", "Zulaika", "Zana", "Zephyrine", "Zora", "Zelpha", "Zulema", "Zelena", "Zephyra", "Zara", "Zelma", "Zelma", "Zosia", "Zephyrine", "Zara", "Zelena", "Zephyra", "Zelma", "Zuzanna", "Zenaide", "Zephyrine", "Zephyra", "Zephyrine", "Zaida", "Zuzana", "Zephyra", "Zephyra", "Zuleika", "Zephyra", "Zephyrine", "Zephyra", "Zelma", "Zelma", "Zephyra", "Zuleika", "Zosia", "Zephyra", "Zuzana", "Zara", "Zephyra", "Zephyra", "Zephyrine", "Zara", "Zuleika", "Zephyra"];

          // Função para verificar o gênero de um nome
          function verificarGeneroDoNome(nome_verificar) {
            let sexo = "-";
            let nome = "";

            // Verifica se o nome está na lista de nomes femininos
            nomef.forEach(function(nome_lista) {
              if (nome_verificar.toLowerCase() === removerAcento(nome_lista.toLowerCase()).toLowerCase()) {
                sexo = "F";
                nome = nome_lista;
              }else{
                // Se o gênero ainda for desconhecido, verifica se o nome está na lista de nomes masculinos
                if (sexo === "-") {
                  nomesMasculinos.forEach(function(nome_lista) {
                    if (nome_verificar.toLowerCase() === removerAcento(nome_lista.toLowerCase()).toLowerCase()) {
                      sexo = "M";
                      nome = nome_lista;
                    }
                  });
                }
              }
            });
            
              // Se não encontrou o nome em nenhuma lista, retorna como desconhecido
              return { sexo: sexo, nome: nome};
          }

          function removerAcento(palavra) {
          // Objeto com as letras acentuadas e suas correspondentes sem acento
          const letrasSemAcento = {
          'á': 'a', 'à': 'a', 'â': 'a', 'ã': 'a', 'ä': 'a', 'é': 'e', 'è': 'e', 'ê': 'e', 'ë': 'e',
          'í': 'i', 'ì': 'i', 'î': 'i', 'ï': 'i', 'ó': 'o', 'ò': 'o', 'ô': 'o', 'õ': 'o', 'ö': 'o',
          'ú': 'u', 'ù': 'u', 'û': 'u', 'ü': 'u', 'ç': 'c'
          };

          // Substitui cada letra acentuada pela sua correspondente sem acento
          let palavraSemAcento = "";
          for (let i = 0; i < palavra.length; i++) {
          const letra = palavra.charAt(i);
          if (letrasSemAcento.hasOwnProperty(letra)) {
          palavraSemAcento += letrasSemAcento[letra]; // Se a letra for acentuada, substitui pela correspondente sem acento
          } else {
          palavraSemAcento += letra; // Se não for acentuada, mantém a letra original
          }
          }

          return palavraSemAcento;
          }




          inputImagem.onchange = function() {
            arquivoImagem = inputImagem.files[0];

              // Atualize a imagem de preview com a URL do arquivo selecionado
              const urlImagem = URL.createObjectURL(arquivoImagem);
              imagemPreview.src = urlImagem;

              // Exiba a imagem de preview
              imagemPreview.style.display = 'block';
          };


          function validacao2() {
            
              //Pessoais
              //--------------
              primeiro_nome = document.querySelector('input[name="primeiro_nome"]').value;
              nome_meio = document.querySelector('input[name="nome_meio"]').value;
              ultimo_nome = document.querySelector('input[name="ultimo_nome"]').value;  
              sexo = document.querySelector('input[name="sexo"]').value;
              data_nascimento = document.querySelector('input[name="data_nascimento"]').value;
              
              //Localizacao
              //--------------
              telefone = document.querySelector('input[name="telefone"]').value;
              morada = document.querySelector('input[name="morada"]').value;
              distrito = document.querySelector('input[name="distrito"]').value;

              if(inputImagem.value.length===0){
                arquivoImagem=document.getElementById('imagem-preview').src;
              }

              //Credenciais
              //--------------
              email = document.querySelector('input[name="email"]').value;
              senha = document.querySelector('input[name="senha"]').value;

              //Recuperacao
              //--------------
              pergunta_recuperacao = document.querySelector('select[name="pergunta_recuperacao"]').value;
              resposta_recuperacao = document.querySelector('input[name="resposta_recuperacao"]').value;
            
              insAuth();   
          }


    //===========================================================================================================
    //TRABALHANDO NA REALTIME DATABASE FIREBASE
    //============================================================================================================

    //===================================
    //VERIFICAR SE O ID DO USUARIO EXISTE
    //====================================
    function isExistUserByEmail(email) {
      const caminhoNoUsuario = `systuinfo/usuario/`+email;
      const referenciaNoUsuario = ref(db, caminhoNoUsuario);

      get(referenciaNoUsuario).then((snapshot) => {
        if (snapshot.exists()) {
          // O nó com a chave 236725342 existe
          return 1;
        } else {
          // O nó com a chave 236725342 não existe
          return 0;
        }
      }).catch((error) => {
        // Ocorreu um erro ao buscar o nó
        console.log("Erro ao verificar a existência do nó:", error);
        return -1;
      });
    }
    
    function isExistImgById(idVerificar) {
      const caminhoNoUsuario = `systuinfo/imagem/${idVerificar}`;
      const referenciaNoUsuario = ref(db, caminhoNoUsuario);

      return get(referenciaNoUsuario).then((snapshot) => {
        if (snapshot.exists()) {
          // O nó com a chave idVerificar existe
          return 1; // Retorna 1 para indicar que a imagem existe
        } else {
          // O nó com a chave idVerificar não existe
          return 0; // Retorna 0 para indicar que a imagem não existe
        }
      }).catch((error) => {
        // Ocorreu um erro ao buscar o nó
        console.error("Erro ao verificar a existência da imagem:", error);
        return -1; // Retorna -1 para indicar um erro
      });
    }
    
    //==============================
    //INSERÇÃO NA BASE DE DADOS
    //==============================
    function insAuth(){
      createUserWithEmailAndPassword(auth, email, senha).then((userCredential) => {
        const usuario = userCredential.user;
        var uid = usuario.uid;
        var emailSemDominio = removerDepoisDoCaractere(email, "@", 1);

        // Caminho no Realtime Database onde você deseja armazenar os dados do usuário
        const dbPath = "systuinfo/usuario/" + emailSemDominio;

        // Referência ao nó no Realtime Database
        const dbRef = ref(db, dbPath);

        // Referência ao local no Firebase Storage onde você deseja armazenar a imagem
        const storagePath = "systuinfo/imagem/" + id_img_gerado;
        const imagemRef = storageRef(storage, storagePath);

        // Fazer upload da imagem para o Firebase Storage
        uploadBytes(imagemRef, arquivoImagem).then((snapshot) => {
          // Obter a URL de download da imagem
          return getDownloadURL(imagemRef);
        }).then((downloadURL) => {

          // Inserir os dados do usuário no Realtime Database, incluindo a URL de download da imagem
          const userData = {
            id_user_auth:uid,

            primeiro_nome: primeiro_nome,
            nome_meio: nome_meio,
            ultimo_nome: ultimo_nome,
            sexo: sexo,
            data_nascimento: data_nascimento,

            telefone: telefone,
            morada: morada,
            distrito: distrito,
            source_img: downloadURL, // Armazene a URL de download da imagem, não o blob

            pergunta_recuperacao: pergunta_recuperacao,
            resposta_recuperacao: resposta_recuperacao
          };

          return set(dbRef, userData);
        }).then(() => {
          window.location.href="index.html";
        }).catch((error) => {
          console.error("Erro: Não foi possível inserir os dados do usuário.", error);
          alert("Erro: Não foi possível inserir os dados do usuário.");
        });
      }).catch((error) => {
        const erro=error.message;
        

      });
    }




      //===================================
      //ESCUTA DE TODOS OS INPUT
      //====================================
      // Seleciona todos os elementos de entrada na página
      document.querySelectorAll('input').forEach((input) => {
        
        // Adiciona um ouvinte de eventos para o evento 'input'
        input.addEventListener('input', () => {
          let nomeattr=input.getAttribute('name');
          
          if(nomeattr==="primeiro_nome"){
            var nome_encontrado=verificarGeneroDoNome(input.value).nome;
            let nome_organizado=nome_encontrado.charAt(0).toUpperCase() + nome_encontrado.slice(1);
            if(verificarGeneroDoNome(input.value).sexo==="M"){            
              input.value=nome_organizado;
              input.classList.remove('is-invalid');
              input.classList.add('is-valid');
              
            }else if(verificarGeneroDoNome(input.value).sexo==="F"){            
              input.value=nome_organizado;
              input.classList.remove('is-invalid');
              input.classList.add('is-valid');document.querySelector('input[name="sexo"]').value="Feminino";
            }else{            
              input.classList.remove('is-valid');
              input.classList.add('is-invalid');
            }
          }else if( nomeattr==="nome_meio" ){ 
            var nome_encontrado=verificarGeneroDoNome(input.value).nome;
            let nome_organizado=nome_encontrado.charAt(0).toUpperCase() + nome_encontrado.slice(1);
            if(verificarGeneroDoNome(input.value).sexo==="M"){        
              input.value=nome_organizado;
              input.classList.remove('is-invalid');
              input.classList.add('is-valid');
            }else{              
              input.classList.remove('is-valid');
              input.classList.add('is-invalid');
            }

          }else if( nomeattr==="ultimo_nome" ){ 
            var nome_encontrado=verificarGeneroDoNome(input.value).nome;
            let nome_organizado=nome_encontrado.charAt(0).toUpperCase() + nome_encontrado.slice(1);
            if(verificarGeneroDoNome(input.value).sexo==="M"){        
              input.value=nome_organizado;
              input.classList.remove('is-invalid');
              input.classList.add('is-valid');
            }else{              
              input.classList.remove('is-valid');
              input.classList.add('is-invalid');
            }

          }else if( nomeattr==="telefone" ){
            var inputString = input.value.toString();
            
            if( !(inputString.substring(0, 2)=='82' || inputString.substring(0, 2)=='83' || inputString.substring(0, 2)=='84' || inputString.substring(0, 2)=='85' || inputString.substring(0, 2)=='86' || inputString.substring(0, 2)=='87')){
                document.getElementById('spantelefone').innerHTML="Telefone deve linha mocambicana.";
              input.classList.remove('is-valid');
              input.classList.add('is-invalid');
              } else if (isNaN(input.value)) {

                document.getElementById('spantelefone').innerHTML="Telefone nao deve conter alguma letra.";
              input.classList.remove('is-valid');
              input.classList.add('is-invalid');
              }else if(input.value.length<9){

              input.classList.remove('is-valid');
              input.classList.add('is-invalid');

                  document.getElementById('spantelefone').innerHTML="Telefone deve ter nove numeros.";  

            }else{
              input.classList.remove('is-invalid');
              input.classList.add('is-valid');
            }
          }else if( nomeattr==="distrito" ){  
            if(input.value.length<6){
              input.classList.remove('is-valid');
              input.classList.add('is-invalid');
                document.getElementById('spansenha').innerHTML="A senha deve ser de 6 digitos.";

            }else{
              input.classList.remove('is-invalid');
              input.classList.add('is-valid');
            }
            if(input.classList.contains('is-valid')){
                document.querySelector('div[espacamento="morada"]').style.display="block";

            }
          }else if( nomeattr==="morada" ){  
            if(input.value.length<6){
              input.classList.remove('is-valid');
              input.classList.add('is-invalid');
                document.getElementById('spansenha').innerHTML="A senha deve ser de 6 digitos.";

            }else{
              input.classList.remove('is-invalid');
              input.classList.add('is-valid');
            }
          }/*else if( nomeattr==="pic_perfil"){
              if(input.value==null){
                input.classList.remove('is-valid');
                input.classList.add('is-invalid');
                  document.getElementById('spansenha').innerHTML="Selecione uma imagem do perfils.";

              }else{
                input.classList.remove('is-invalid');
                input.classList.add('is-valid');
              }

          }*/else if( nomeattr==="email" ){ 
            if(!(input.value.includes("@gmail.com") || input.value.includes("@ucm.ac.mz"))){
              input.classList.remove('is-valid');
              input.classList.add('is-invalid');
                document.getElementById('spansenha').innerHTML="Prefixo valido '@gmail.com ou @ucm.ac.mz'.";

            }else{

              var emailSemDominio = removerDepoisDoCaractere(input.value, "@", 1);

              input.classList.remove('is-invalid');
              input.classList.add('is-valid');
              var i=0;
              var estadouser=isExistUserByEmail(emailSemDominio);
              while(estadouser==1){
                estadouser=isExistUserByEmail(emailSemDominio);
                i++;
                if(i==10000){
                  break;
                }
              }
            }
            
          }else if( nomeattr==="senha" ){ 
            if(input.value.length<6){
              input.classList.remove('is-valid');
              input.classList.add('is-invalid');
                document.getElementById('spansenha').innerHTML="A senha deve ser de 6 digitos.";

            }else{
              input.classList.remove('is-invalid');
              input.classList.add('is-valid');
            }
            if(input.classList.contains('is-valid')){
            }
          }else if(nomeattr==="resposta_recuperacao"){
            if(input.value.length<=2){
              input.classList.remove('is-valid');
              input.classList.add('is-invalid');

                document.getElementById('span_resposta_recuperacao').innerHTML="A resposta deve ter no minimo 3 letras e no maximo 30 letras";            


            }else{  
              input.classList.remove('is-invalid');
              input.classList.add('is-valid');
            }
          }
        });
      });




      // Seleciona todos os elementos de entrada na página
      document.querySelectorAll('select').forEach((select) => {
        
        // Adiciona um ouvinte de eventos para o evento 'input'
        select.addEventListener('input', () => {
          var nomeattr=select.getAttribute('name');

          if( nomeattr==="nivel" ){ 
            if(select.value===""){
              select.classList.remove('is-valid');
              select.classList.add('is-invalid');
                document.getElementById('spansenha').innerHTML="A senha deve ser de 6 digitos.";

            }else{
              select.classList.remove('is-invalid');
              select.classList.add('is-valid');
            }
            if(select.classList.contains('is-valid')){
                document.querySelector('div[espacamento="email"]').style.display="block";
              document.getElementById('formParteInferior').style.display="block";
            }
          }else if( nomeattr==="pergunta_recuperacao" ){  
            if(select.value===""){
              select.classList.remove('is-valid');
              select.classList.add('is-invalid');
                document.getElementById('spansenha').innerHTML="A senha deve ser de 6 digitos.";

            }else{
              select.classList.remove('is-invalid');
              select.classList.add('is-valid');
            }
            if(select.classList.contains('is-valid')){
                document.querySelector('div[espacamento="resposta_recuperacao"]').style.display="block";
            }
          }

        });
      });

      document.querySelectorAll('button').forEach((button)=>{
        button.addEventListener('click',()=>{
            var nomeattr=button.getAttribute('name');
          if(nomeattr==="btn_no_pic"){
            document.getElementById(button.parentNode.parentNode.id).style.display="none";
            document.getElementById('formParteInferior').style.display="block";
              document.querySelector('div[espacamento="nivel"]').style.display="block";
          }
        });
      });

      //==================================================================================================
      //ESCUTA DE TODOS OS SPAN ou invalid-feedback com valid-feedback
      //===================================================================================================
      // Seleciona todos os elementos de entrada na página



      // Função para criar um usuário com e-mail e senha e associar dados adicionais



      // Example starter JavaScript for disabling form submissions if there are invalid fields



       /** 
       * REMOCAO DE TODOS
       */

      function removerDepoisDoCaractere(str, caractere, valor) {
          var index = str.indexOf(caractere);
          if (index !== -1) {
              return str.substring(0, index + valor);
          }
          return str;
      }


      (function () {
        'use strict'

        // Fetch all the forms we want to apply custom Bootstrap validation styles to
        var forms = document.querySelectorAll('.needs-validation')

        // Loop over them and prevent submission
        Array.prototype.slice.call(forms)
          .forEach(function (form) {
            form.addEventListener('submit', function (event) {
              event.preventDefault()
              if (!form.checkValidity()) {
                event.stopPropagation()

              }else{
                validacao2();
              }
              form.classList.add('was-validated')
            }, false)
          })
      })()
    </script>
    <script ></script>
  </body>
</html>
